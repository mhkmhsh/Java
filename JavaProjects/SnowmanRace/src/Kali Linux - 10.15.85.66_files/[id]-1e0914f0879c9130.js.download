(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[834],{1746:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/classrooms/[id]",function(){return n(8423)}])},1968:function(e,t,n){"use strict";var s=n(5893),l=n(1163),r=n(7294),i=n(2445),o=n(3523),a=n(6137),d=n(61),c=n(3193),u=n(7841),h=n(4685),x=n(7248),m=n(1513),j=n(1664),p=n.n(j),g=n(9118),v=n(5165),C=n(3575),f=n(8931);t.Z=()=>{let{setUser:e,setLoadingUser:t}=(0,r.useContext)(g.S),n=(0,l.useRouter)(),j=(0,x.c)({initialValues:{email:"",password:""},validate:{email:e=>e.length>0?null:"Invalid Email or Username",password:e=>e.length>0?null:"Invalid password"}}),b=async s=>{t(!0),(0,v.x4)(s.email,s.password).then(s=>{(null==s?void 0:s.success)?(0,v.AW)().then(s=>{e(null==s?void 0:s.content),t(!1),"/login"==n.asPath&&n.push("/classrooms")}):(t(!1),(0,C.c0)({title:"Error",message:null==s?void 0:s.error,color:"red"}))})};return(0,s.jsxs)(i.W,{size:"xs",children:[(0,s.jsx)(o.M,{children:(0,s.jsx)(m.Z,{})}),(0,s.jsx)(a.Z,{position:"center",grow:!0,children:(0,s.jsxs)("form",{onSubmit:j.onSubmit(b),children:[(0,s.jsx)(d.o,{label:"Email or Username",placeholder:"your@email.com",...j.getInputProps("email")}),(0,s.jsx)(c.W,{label:"Password",placeholder:"Password",...j.getInputProps("password")}),(0,s.jsx)(a.Z,{position:"right",mt:"md",children:(0,s.jsx)(u.z,{disabled:!j.isValid(),type:"submit",children:"Login"})})]})}),(0,s.jsxs)("div",{children:["Don't have an account? ",(0,s.jsx)(h.e,{component:p(),href:"/apply",children:"Apply for one!"})]}),(0,s.jsx)("div",{children:(0,s.jsx)(h.e,{component:p(),href:"/forgot-password",children:"Forgot password "})}),(0,s.jsx)("br",{}),(0,s.jsx)("div",{children:(0,s.jsx)(f.Z,{})})]})}},1513:function(e,t,n){"use strict";var s=n(5893),l=n(5675),r=n.n(l);t.Z=e=>{let{width:t=400,height:n=150}=e;return(0,s.jsx)("div",{className:"logo-container",children:(0,s.jsx)(r(),{src:"/CYBERORGLogo.svg",width:t,height:n})})}},8931:function(e,t,n){"use strict";var s=n(5893),l=n(2593),r=n(7294),i=n(6085),o=n(5434);t.Z=()=>{let{notifVis:e,notifType:t,notifTitle:n,notifBody:a}=(0,r.useContext)(i.X);return"true"==e?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(l.P,{icon:(0,s.jsx)(o.YTL,{}),withCloseButton:!1,color:"warn"==t?"red":"blue",title:"NOTICE: "+n.toString(),style:{wordWrap:"break-word"},children:a.toString()})}):(0,s.jsx)(s.Fragment,{})}},1930:function(e,t,n){"use strict";var s=n(5893),l=n(7294),r=n(9118),i=n(1968);t.Z=e=>{let{children:t}=e,{user:n}=(0,l.useContext)(r.S);return n?t:(0,s.jsx)(i.Z,{})}},8423:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ej}});var s=n(5893),l=n(9008),r=n.n(l),i=n(1163),o=n(1017),a=n(6137),d=n(9236),c=n(5117),u=n(9834),h=n(7841),x=n(4777),m=n(4761),j=n(5078),p=n(7294),g=n(3750),v=n(8454),C=n(7789),f=n(2604),b=e=>{let{machineInfo:t}=e,{handleOpenRange:n}=(0,p.useContext)(f.e),l=()=>{switch(t.status){case"queue to boot":case"queue to terminate":return"red";case"booting":return"orange";case"setting up":return"yellow";case"booted":return"green";default:return"black"}};return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(v.z,{withArrow:!0,children:[(0,s.jsx)(v.z.Target,{children:"booted"===t.status?(0,s.jsx)(C.C,{style:{cursor:"pointer"},color:l(),onClick:()=>n(t),variant:"dot",children:t.instance_type__label}):(0,s.jsx)(C.C,{color:l(),variant:"dot",children:t.instance_type__label})}),(0,s.jsxs)(v.z.Dropdown,{children:[(0,s.jsx)(d.D,{order:4,children:t.instance_type__label}),(0,s.jsxs)(c.x,{children:["Status: ",t.status]})]})]})})},w=n(7957),y=n(9510),S=n(5217);let k=(0,p.createContext)(null),_=e=>{let{children:t,id:n}=e,[l,r]=(0,p.useState)(null),[o,a]=(0,p.useState)([]),[d,c]=(0,p.useState)([]),[u,h]=(0,p.useState)([]);(0,i.useRouter)(),(0,p.useEffect)(()=>((0,y.aS)(n).then(e=>{(null==e?void 0:e.success)&&x(null==e?void 0:e.data)}),()=>{m.stop()}),[n]);let x=e=>{(0,w.V3)(n).then(e=>{(null==e?void 0:e.success)&&r(null==e?void 0:e.content)}),a(e),h(e.map(e=>({nickname:e.nickname,username:e.username,password:e.password})));let t=[];for(let n=0;n<e.length;n++)for(let s=0;s<e[n].instances.length;s++)t.push({...e[n].instances[s],owner:e[n].username,nickname:e[n].nickname});c(t),C(e)},m=(0,S.Y)(()=>{(0,y.aS)(n).then(e=>{(null==e?void 0:e.success)&&(x(null==e?void 0:e.data),C(null==e?void 0:e.data))})},6e4),[j,g]=(0,p.useState)(0),v=(0,S.Y)(()=>g(e=>e+1),1e3,{autoInvoke:!0}),C=e=>{e.filter(e=>{for(let t=0;t<e.instances.length;t++)switch(e.instances[t].status){case"queue to boot":case"booting":case"setting up":case"queue to terminate":return!0}return!1}).length>0?m.start():m.stop()};return(0,s.jsx)(k.Provider,{value:{classroomData:l,setClassroomData:r,participants:o,handleSetParticipants:x,csvData:u,currentInstances:d,setCurrentInstances:c,refreshManual:()=>{(0,y.aS)(n).then(e=>{(null==e?void 0:e.success)&&(x(null==e?void 0:e.data),g(0),v.start())})},seconds:j},children:t})};var Z=n(2716),z=n(61),E=n(50),F=n(3941),P=n(9588),V=e=>{let{machineInfo:t}=e;console.log(t);let{classroomData:n,handleSetParticipants:l}=(0,p.useContext)(k),{handleOpenRange:r}=(0,p.useContext)(f.e),i=()=>{switch(t.status){case"queue to boot":return{statusColor:"red",progressValue:2};case"booting":return{statusColor:"orange",progressValue:25};case"setting up":return{statusColor:"yellow",progressValue:60};case"booted":return{statusColor:"blue",progressValue:100};case"queue to terminate":return{statusColor:"red",progressValue:100};default:return{statusColor:"black",progressValue:0}}},u=new Date(t.created_at),x=u.getHours(),m=new String(u.getMinutes()).padStart(2,0),j=new Date(t.expires_at),g=j.getHours(),v=new String(j.getMinutes()).padStart(2,0);return(null==t?void 0:t.status)=="booted"?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(o.Z,{my:"md",pt:"xs",children:[(0,s.jsxs)(a.Z,{position:"apart",children:[(0,s.jsx)(d.D,{order:4,mt:0,children:t.instance_type__label}),t.nickname&&(0,s.jsx)(d.D,{order:4,mt:0,children:t.nickname})]}),(0,s.jsxs)(a.Z,{position:"apart",children:[(0,s.jsxs)(c.x,{children:["Created At: ",x,":",m]}),(0,s.jsxs)(c.x,{children:["Status: ",t.status]})]}),(0,s.jsxs)(a.Z,{position:"apart",children:[(0,s.jsxs)(c.x,{children:["Expires At: ",g,":",v]}),(0,s.jsxs)(c.x,{children:["IP: ",t.private_ip]})]}),(0,s.jsxs)(E.r,{mt:1,justify:"center",children:[(0,s.jsx)(E.r.Col,{span:8,children:(0,s.jsx)(h.z,{size:"xs",fullWidth:!0,onClick:()=>r(t),children:"Connect"})}),(0,s.jsx)(E.r.Col,{span:4,children:(0,s.jsx)(h.z,{size:"xs",fullWidth:!0,color:"red",onClick:()=>{(0,P.Ky)([t.id],"queue to terminate").then(e=>{(null==e?void 0:e.success)&&(0,y.aS)(n.id).then(e=>{(null==e?void 0:e.success)&&l(null==e?void 0:e.data)})})},children:"Terminate"})})]})]})}):(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(o.Z,{my:"md",pt:"xs",children:[(0,s.jsx)(d.D,{order:4,mt:0,children:t.type}),(0,s.jsx)(a.Z,{position:"apart",children:(0,s.jsxs)(c.x,{children:["Status: ",t.status]})}),(0,s.jsx)(F.E,{value:i().progressValue,color:i().statusColor})]})})},D=e=>{let{opened:t,onClose:n,participant:l}=e,{classroomData:r,handleSetParticipants:i,participants:o}=(0,p.useContext)(k),[u,x]=(0,p.useState)(null),[m,j]=(0,p.useState)(""),[g,v]=(0,p.useState)("");return(0,p.useEffect)(()=>{let e=null==o?void 0:o.filter(e=>e.id===(null==l?void 0:l.id));e.length>0&&x(e[0])},[l,o]),(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(Z.d,{opened:t,onClose:n,title:(0,s.jsx)(d.D,{order:3,children:"Edit Participant"}),size:"md",position:"right",padding:"xl",children:[(0,s.jsx)(z.o,{label:"Nickname",value:m,onChange:e=>j(e.currentTarget.value),placeholder:null==u?void 0:u.nickname}),(null==u?void 0:u.user_type)==2&&(0,s.jsx)(z.o,{mt:"md",label:"Password",value:g,onChange:e=>v(e.currentTarget.value),placeholder:null==u?void 0:u.password}),(0,s.jsx)(a.Z,{mt:"md",position:"right",children:(0,s.jsx)(h.z,{onClick:()=>{(0,y.mK)(l.id,m,g).then(e=>{(null==e?void 0:e.success)&&((0,y.aS)(null==r?void 0:r.id).then(e=>{i(null==e?void 0:e.data)}),j(""),v(""))})},disabled:!m&&!g,children:"Save Changes"})}),(0,s.jsx)(d.D,{mt:"md",order:4,children:"Active Machines"}),(null==u?void 0:u.instances.length)>0?null==u?void 0:u.instances.map(e=>(0,s.jsx)(V,{machineInfo:e},e.id)):(0,s.jsx)(c.x,{children:"There are no active VMs"})]})})},I=()=>{let{participants:e}=(0,p.useContext)(k),[t,n]=(0,p.useState)(!1),[l,r]=(0,p.useState)(!1),[i,o]=(0,p.useState)(null),d=(0,m.rZ)(),u=e=>{o(e),r(!0)},h=(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Nickname"}),(0,s.jsx)("th",{children:"Username"}),(0,s.jsx)("th",{children:(0,s.jsxs)(a.Z,{position:!0,children:["Password",t?(0,s.jsx)(g.cqT,{style:{color:d.colors.blue[6],cursor:"pointer"},onClick:()=>n(e=>!e)}):(0,s.jsx)(g.rnh,{style:{color:d.colors.blue[6],cursor:"pointer"},onClick:()=>n(e=>!e)})]})}),(0,s.jsx)("th",{children:"Active Machines"}),(0,s.jsx)("th",{children:"Options"})]}),x=e.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e.nickname}),(0,s.jsx)("td",{children:e.username}),(0,s.jsx)("td",{children:t&&e.password}),(0,s.jsx)("td",{children:e.instances.map(e=>(0,s.jsx)(b,{machineInfo:e},e.id))}),(0,s.jsx)("td",{children:(0,s.jsx)(c.x,{style:{color:d.colors.blue[6],cursor:"pointer"},onClick:()=>u(e),children:"Edit"})})]},e.id));return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(j.i,{striped:!0,highlightOnHover:!0,children:[(0,s.jsx)("thead",{children:h}),(0,s.jsx)("tbody",{children:x})]}),(0,s.jsx)(D,{opened:l,onClose:()=>r(!1),participant:i})]})},T=n(5434),A=n(8310),M=n(4127),L=n(9118),N=n(3575),q=e=>{let{opened:t,onClose:n}=e,{classroomData:l,setClassroomData:r}=(0,p.useContext)(k),{user:i}=(0,p.useContext)(L.S),[o,u]=(0,p.useState)(""),[x,m]=(0,p.useState)("");return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(Z.d,{opened:t,onClose:n,title:(0,s.jsx)(d.D,{order:3,children:"Classroom Settings"}),size:"lg",position:"right",padding:"xl",children:[(0,s.jsx)(z.o,{label:"Classroom Name",placeholder:null==l?void 0:l.name,value:o,onChange:e=>u(e.currentTarget.value)}),(null==i?void 0:i.is_staff)&&(0,s.jsx)(M.Y,{my:"sm",label:"Participant Limit",description:"From 1 to 300",placeholder:"current: ".concat(null==l?void 0:l.participant_limit),value:x,onChange:e=>m(e),min:1,max:300}),(0,s.jsx)(a.Z,{my:"sm",position:"right",children:(0,s.jsx)(h.z,{disabled:!o&&!x,onClick:()=>{(0,w.E5)(null==l?void 0:l.id,o,x).then(e=>{(null==e?void 0:e.content)&&(0,w.V3)(null==l?void 0:l.id).then(e=>{(null==e?void 0:e.success)&&(r(null==e?void 0:e.content),u(""),m(""),(0,N.c0)({title:"Changes Saved",message:(0,s.jsxs)(c.x,{children:["Classroom Name: ",null==e?void 0:e.content.name,(null==i?void 0:i.is_staff)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("br",{}),"Participant Limit: ",null==e?void 0:e.content.participant_limit]})]})}),n())})})},children:"Save Changes"})})]})})},R=n(4491),O=n(7084),W=e=>{let{opened:t,onClose:n}=e,{participants:l,classroomData:r,handleSetParticipants:i}=(0,p.useContext)(k);return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(R.u,{opened:t,onClose:n,title:(0,s.jsx)(d.D,{order:4,children:"Terminate All VMs"}),children:[(0,s.jsxs)(c.x,{my:"md",children:["This will terminate every VM with a status of ",(0,s.jsx)(O.E,{children:"setting up"})," or ",(0,s.jsx)(O.E,{children:"booted"}),". Are you sure you want to continue?"]}),(0,s.jsx)(h.z,{onClick:()=>{let e=[];for(let t=0;t<l.length;t++)if(l[t].instances.length>0)for(let n=0;n<l[t].instances.length;n++)e.push(l[t].instances[n].id);(0,P.Ky)(e,"queue to terminate").then(e=>{(null==e?void 0:e.success)&&(0,y.aS)(r.id).then(e=>{(null==e?void 0:e.success)&&(i(null==e?void 0:e.data),n())})})},fullWidth:!0,children:"Yes"})]})})},Y=n(3461),G=n(1194),H=e=>{let{opened:t,onClose:n}=e,{participants:l,classroomData:r,handleSetParticipants:i}=(0,p.useContext)(k),[o,u]=(0,p.useState)([]),x=null==l?void 0:l.filter(e=>0===e.instances.length&&2===e.user_type),m=null==x?void 0:x.map(e=>({value:e.id,label:e.nickname}));return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(Z.d,{opened:t,onClose:n,title:(0,s.jsx)(d.D,{order:3,children:"Remove Participants"}),size:"lg",padding:"md",position:"right",children:[(0,s.jsx)(c.x,{children:"Select the participants you would like to remove from the classroom. Only participants with no active virtual machines are shown."}),(0,s.jsxs)(a.Z,{my:"sm",position:"apart",children:[(0,s.jsxs)(a.Z,{children:[(0,s.jsx)(h.z,{disabled:(null==o?void 0:o.length)===(null==m?void 0:m.length),onClick:()=>{u(null==m?void 0:m.map(e=>e.value))},children:"Select All"}),(0,s.jsx)(h.z,{disabled:(null==o?void 0:o.length)<1,onClick:()=>{u([])},children:"Clear"})]}),(0,s.jsx)(h.z,{disabled:(null==o?void 0:o.length)<1,onClick:()=>{(0,y.sW)(o).then(e=>{(null==e?void 0:e.success)&&((0,y.aS)(r.id).then(e=>{(null==e?void 0:e.success)&&i(null==e?void 0:e.data)}),(0,N.c0)({title:"Success",message:""}),n())})},children:"Submit"})]}),(0,s.jsx)(G.NU,{placeholder:"Choose at least one",value:o,onChange:u,data:m})]})})},U=()=>{let[e,t]=(0,p.useState)(!1),[n,l]=(0,p.useState)(!1),[r,i]=(0,p.useState)(!1),{classroomData:o,csvData:a}=(0,p.useContext)(k),d=(0,m.rZ)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(A.v,{shadow:"md",position:"bottom-end",children:[(0,s.jsx)(A.v.Target,{children:(0,s.jsx)(u.A,{variant:"filled",children:(0,s.jsx)(g.evw,{})})}),(0,s.jsxs)(A.v.Dropdown,{children:[(0,s.jsx)(A.v.Item,{icon:(0,s.jsx)(g.kj6,{}),onClick:()=>l(!0),children:"Remove Participants"}),(0,s.jsx)(A.v.Item,{icon:(0,s.jsx)(g.QNI,{}),children:(0,s.jsx)(Y.CSVLink,{style:{color:"light"==d.colorScheme?"black":d.colors.gray[5],textDecoration:"none"},data:a,filename:"".concat(null==o?void 0:o.name,"_info.csv"),children:"Download CSV"})}),(0,s.jsx)(A.v.Item,{onClick:()=>i(!0),icon:(0,s.jsx)(g.St1,{}),children:"Terminate\xa0VMs"}),(0,s.jsx)(A.v.Item,{onClick:()=>t(!0),icon:(0,s.jsx)(g.FBj,{}),children:"Settings"})]})]}),(0,s.jsx)(W,{opened:r,onClose:()=>i(!1)}),(0,s.jsx)(q,{opened:e,onClose:()=>t(!1)}),(0,s.jsx)(H,{opened:n,onClose:()=>l(!1)})]})},X=e=>{let{opened:t,onClose:n}=e,{classroomData:l,handleSetParticipants:r}=(0,p.useContext)(k),[i,u]=(0,p.useState)(1);return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(Z.d,{opened:t,onClose:n,title:(0,s.jsx)(d.D,{order:3,children:"Add Participants"}),size:"lg",position:"right",padding:"xl",children:[(0,s.jsx)(c.x,{my:"sm",children:"Input the number of anonymous participants you would like to add to your classroom."}),(0,s.jsx)(c.x,{my:"sm",children:"A random username and password is generated for each participant. The username cannot be changed, but the teacher can set the password."}),(0,s.jsxs)(o.Z,{my:"sm",children:[(0,s.jsxs)(c.x,{children:["Current: ",null==l?void 0:l.participant_count]}),(0,s.jsxs)(c.x,{children:["Remaining: ",(null==l?void 0:l.participant_limit)-(null==l?void 0:l.participant_count)]}),(0,s.jsxs)(c.x,{children:["Total Allowed: ",null==l?void 0:l.participant_limit]})]}),(0,s.jsx)(M.Y,{label:"How many would you like to add?",placeholder:"ex: 10",min:1,max:(null==l?void 0:l.participant_limit)-(null==l?void 0:l.participant_count),value:i,onChange:u}),(0,s.jsx)(a.Z,{my:"sm",position:"right",children:(0,s.jsx)(h.z,{onClick:()=>{(0,y.Mo)(null==l?void 0:l.id,i).then(e=>{(null==e?void 0:e.success)&&(0,y.aS)(null==l?void 0:l.id).then(e=>{(null==e?void 0:e.success)&&(r(null==e?void 0:e.data),n())})})},children:"Submit"})})]})})},B=n(8855),K=e=>{let{opened:t,onClose:n,classroomData:l}=e,[r,i]=(0,p.useState)([]),[o,u]=(0,p.useState)(""),[x,m]=(0,p.useState)([]),[j,g]=(0,p.useState)([]),{handleSetParticipants:v}=(0,p.useContext)(k);(0,p.useEffect)(()=>{m([]),l&&(0,y.aS)(null==l?void 0:l.id).then(e=>{if(null==e?void 0:e.success){v(null==e?void 0:e.data);let t=null==e?void 0:e.data.filter(e=>{for(let t=0;t<e.instances.length;t++)if(e.instances[t].instance_type_id===o)return!1;return!0});i(t=t.map(e=>({value:e.id,label:e.nickname})))}})},[o]),(0,p.useEffect)(()=>{(0,P.pS)().then(e=>{(null==e?void 0:e.success)&&g(null==e?void 0:e.content.map(e=>({value:e.id,label:e.label})))})},[]);let C=()=>{u(""),m([]),i([])};return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(Z.d,{opened:t,onClose:()=>{C(),n()},title:(0,s.jsx)(d.D,{order:3,children:"Launch Machines"}),position:"right",size:"lg",padding:"xl",children:[(0,s.jsxs)(a.Z,{mt:"md",position:"apart",noWrap:!0,children:[(0,s.jsx)(c.x,{children:"Launch Machines for students in your Classroom"}),(0,s.jsx)(h.z,{disabled:""===o||x.length<1,onClick:()=>{(0,P.Xd)(o,x).then(e=>{(null==e?void 0:e.success)&&(C(),n())}).catch(e=>console.log(e))},children:"Launch"})]}),(0,s.jsx)(B.Ph,{mt:"md",label:"Machine Type",placeholder:"Pick One",data:j,value:o,onChange:u}),(0,s.jsxs)(a.Z,{my:"md",position:"apart",children:[(0,s.jsx)(c.x,{children:"For Whom?"}),(0,s.jsxs)(a.Z,{position:"right",children:[(0,s.jsx)(h.z,{compact:!0,disabled:""===o||(null==x?void 0:x.length)===(null==r?void 0:r.length),onClick:()=>{m(null==r?void 0:r.map(e=>e.value))},children:"Select All"}),(0,s.jsx)(h.z,{compact:!0,disabled:""===o||(null==x?void 0:x.length)===0,onClick:()=>{m([])},children:"Clear"})]})]}),(0,s.jsx)(G.NU,{disabled:""===o,"aria-label":"For whom?",placeholder:"Pick at least 1",value:x,onChange:m,data:r})]})})},Q=n(4942),J=n(3723),$=e=>{var t;let n;let{opened:l,onClose:r}=e,{currentInstances:i}=(0,p.useContext)(k),[o,a]=(0,p.useState)("");return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(Z.d,{position:"right",opened:l,onClose:r,title:(0,s.jsx)(d.D,{order:3,children:"Your VMs"}),size:"lg",padding:"lg",children:[(0,s.jsx)(z.o,{label:"Filter by nickname",placeholder:"ex: Jane",value:o,onChange:e=>a(e.currentTarget.value)}),(0,s.jsx)(J.x.Autosize,{maxHeight:"90%",children:null===(n=[...i],o.length>0&&(n=n.filter(e=>e.nickname.toLowerCase().includes(o.toLowerCase()))),t=n)||void 0===t?void 0:t.map(e=>(0,s.jsx)(V,{machineInfo:e},e.id))})]})})},ee=()=>{let[e,t]=(0,p.useState)(!1),[n,l]=(0,p.useState)(!1),{classroomData:i,refreshManual:m,seconds:j}=(0,p.useContext)(k),{rangeIsOpen:v,otherMachinesOpen:C,setOtherMachinesOpen:b}=(0,p.useContext)(f.e);return v?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Q.Z,{}),(0,s.jsx)($,{opened:C,onClose:()=>b(!1)})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r(),{children:[(0,s.jsx)("title",{children:i?i.name:"Classrooms"}),(0,s.jsx)("meta",{name:"description",content:"Classroom named ".concat(null==i?void 0:i.name)}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsxs)(o.Z,{mt:"md",withBorder:!0,style:{overflow:"visible"},children:[(0,s.jsxs)(a.Z,{position:"apart",children:[(0,s.jsx)(a.Z,{children:(0,s.jsx)(d.D,{order:4,children:null==i?void 0:i.name})}),(0,s.jsxs)(a.Z,{position:"right",spacing:"xs",children:[(0,s.jsxs)(a.Z,{children:[(0,s.jsxs)(c.x,{c:"dimmed",size:"xs",children:["Time since last refresh: ",(0,s.jsx)("b",{children:j}),"s."]}),(0,s.jsx)(u.A,{variant:"outline",color:"yellow",onClick:m,disabled:j<=30&&0!=j,children:(0,s.jsx)(T.hX9,{})})]}),(0,s.jsx)(h.z,{compact:!0,color:"green",onClick:()=>t(!0),children:"Launch VMs"}),(0,s.jsx)(u.A,{variant:"filled",color:"blue",onClick:()=>l(!0),disabled:(null==i?void 0:i.participant_count)>=(null==i?void 0:i.participant_limit),children:(0,s.jsx)(g.im1,{})}),(0,s.jsx)(U,{})]})]}),(0,s.jsx)(x.i,{my:"md",size:"sm"}),(0,s.jsx)(I,{})]}),(0,s.jsx)(K,{opened:e,onClose:()=>t(!1),classroomData:i}),(0,s.jsx)(X,{opened:n,onClose:()=>l(!1)})]})},et=n(966),en=n(4685),es=n(3284),el=n(1930),er=n(6542),ei=e=>{let{machineInfo:t}=e,{participantInfo:n,id:l,handleSetParticipantInfo:r}=(0,p.useContext)(er.G);return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(o.Z,{mt:"sm",children:(0,s.jsxs)(a.Z,{position:"apart",children:[(0,s.jsx)(d.D,{order:3,children:t.label}),(0,s.jsx)(a.Z,{children:(0,s.jsx)(h.z,{onClick:()=>{(0,P.Xd)(t.id,[n.id]).then(e=>{(null==e?void 0:e.success)&&(0,y.aS)(l).then(e=>{(null==e?void 0:e.success)&&r(null==e?void 0:e.data)})})},children:"Launch"})})]})})})},eo=n(7414),ea=n(7564),ed=e=>{let{machineInfo:t}=e,{handleOpenRange:n}=(0,p.useContext)(f.e),{id:l,handleSetParticipantInfo:r}=(0,p.useContext)(er.G),i=()=>{(0,P.Ky)([t.id],"queue to terminate").then(e=>{(null==e?void 0:e.success)&&(0,y.aS)(l).then(e=>{(null==e?void 0:e.success)&&r(null==e?void 0:e.data)})})},u=()=>{switch(t.status){case"queue to boot":return{statusColor:"red",progressValue:2,animate:!0};case"booting":return{statusColor:"orange",progressValue:25,animate:!0};case"setting up":return{statusColor:"yellow",progressValue:60,animate:!0};case"booted":return{statusColor:"blue",progressValue:100,animate:!1};case"queue to terminate":return{statusColor:"red",progressValue:100,animate:!0};default:return{statusColor:"black",progressValue:0,animate:!1}}},x=new Date(t.expires_at),m=x.getHours(),j=new String(x.getMinutes()).padStart(2,0);return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(o.Z,{my:"sm",children:[(0,s.jsxs)(a.Z,{position:"apart",children:[(0,s.jsx)(d.D,{order:3,children:t.instance_type__label}),(0,s.jsxs)(a.Z,{position:"right",children:[(0,s.jsx)(h.z,{disabled:"booted"!==t.status,onClick:()=>n(t),children:"Connect"}),(0,s.jsx)(h.z,{color:"red",disabled:"booted"!==t.status,onClick:()=>i(),children:"Terminate"})]})]}),(0,s.jsxs)(a.Z,{position:"apart",children:[(0,s.jsxs)(eo.x,{children:[(0,s.jsxs)(c.x,{children:["Status: ",t.status]}),(0,s.jsxs)(c.x,{children:["IP: ",t.private_ip]})]}),(0,s.jsx)(ea.K,{children:(0,s.jsxs)(c.x,{children:["Expires At: ",m,":",j]})})]}),(0,s.jsx)(F.E,{value:u().progressValue,color:u().statusColor,animate:u().animate})]})})},ec=e=>{let{opened:t,onClose:n}=e,{currentInstances:l}=(0,p.useContext)(er.G);return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(Z.d,{position:"right",opened:t,onClose:n,title:(0,s.jsx)(d.D,{order:3,children:"Your VMs"}),size:"lg",padding:"lg",children:null==l?void 0:l.map(e=>(0,s.jsx)(ed,{machineInfo:e},e.id))})})},eu=()=>{let{currentInstances:e,availableInstances:t}=(0,p.useContext)(er.G),{rangeIsOpen:n,otherMachinesOpen:l,setOtherMachinesOpen:r}=(0,p.useContext)(f.e);return n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Q.Z,{}),(0,s.jsx)(ec,{opened:l,onClose:()=>r(!1)})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.D,{order:3,children:"Current VMs"}),null==e?void 0:e.map(e=>(0,s.jsx)(ed,{machineInfo:e},e.id)),(0,s.jsx)(x.i,{my:"md"}),(0,s.jsx)(d.D,{order:3,children:"Available to Launch"}),null==t?void 0:t.map(e=>(0,s.jsx)(ei,{machineInfo:e},e.id))]})},eh=n(1664),ex=n.n(eh);let em=()=>{let{classroomData:e}=(0,p.useContext)(k),t=[{title:"Classrooms",href:"/classrooms"},{title:null==e?void 0:e.name,href:"/classrooms/".concat(null==e?void 0:e.id)}].map((e,t)=>(0,s.jsx)(en.e,{component:ex(),href:e.href,children:e.title},t));return(0,s.jsx)(es.O,{children:t})};var ej=()=>{let{id:e}=(0,i.useRouter)().query,{user:t}=(0,p.useContext)(L.S),{rangeIsOpen:n}=(0,p.useContext)(f.e),l=(0,s.jsxs)(r(),{children:[(0,s.jsx)("title",{children:"Classrooms"}),(0,s.jsx)("meta",{name:"description",content:"CYBER.ORG Classrooms"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]});return e&&((null==t?void 0:t.is_staff)||(null==t?void 0:t.type)==1)?(0,s.jsxs)(s.Fragment,{children:[l,(0,s.jsx)(el.Z,{children:(0,s.jsxs)(_,{id:e,children:[!1===n&&(0,s.jsx)(em,{}),(0,s.jsx)(ee,{})]})})]}):e&&(null==t?void 0:t.type)==2?(0,s.jsxs)(s.Fragment,{children:[l,(0,s.jsx)(el.Z,{children:(0,s.jsx)(er.P,{id:e,children:(0,s.jsx)(eu,{})})})]}):(0,s.jsxs)(s.Fragment,{children:[l,(0,s.jsx)(et.a,{})]})}},7957:function(e,t,n){"use strict";n.d(t,{E5:function(){return a},V3:function(){return o},_I:function(){return r},aQ:function(){return i},o3:function(){return l}});var s=n(5799);let l=async()=>{try{let e=await s.Z.get("/classrooms/list/");return await e.data}catch(e){return Promise.reject("Error Getting Classrooms")}},r=async e=>{try{let t=await s.Z.post("/classrooms/create/",{name:e});return await t.data}catch(e){return Promise.reject("Error Creating Classroom")}},i=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=new URL("".concat(s._,"/classrooms/list/?as_staff=true"));e.map(e=>t.searchParams.append(e.name,e.value));try{let e=await s.Z.get(t);return await e.data}catch(e){return Promise.reject("Error Getting Classrooms")}},o=async e=>{try{let t=await s.Z.get("classrooms/id/".concat(e,"/"));return await t.data}catch(e){return Promise.reject({message:"Error Getting Classroom",status:e.response.status})}},a=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{let l=await s.Z.post("/classrooms/edit/",{id:e,name:t,participant_limit:n});return await l.data}catch(e){return Promise.reject("Error Editing Classroom")}}}},function(e){e.O(0,[283,586,97,509,871,855,468,840,589,774,888,179],function(){return e(e.s=1746)}),_N_E=e.O()}]);